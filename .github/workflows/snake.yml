name: Running Snake Animation

on:
  workflow_dispatch:
  schedule:
    - cron: "0 0 * * *"

jobs:
  generate:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      
      # 1. –°–æ–∑–¥–∞–µ–º –ù–ê–°–¢–û–Ø–©–£–Æ –±–µ–≥–∞—é—â—É—é –∑–º–µ–π–∫—É —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å
      - name: Generate running snake
        run: |
          echo "üéØ Creating RUNNING snake pattern..."
          
          # –°–ø–æ—Å–æ–± 1: –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–º–µ–π–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
          curl -s "https://github-contributions-snake.vercel.app/github-snake.svg?user=djedra&snake=true&animation=true" > snake.svg
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
          echo "üîç Checking snake pattern..."
          if grep -q "snake" snake.svg || grep -q "path.*d=" snake.svg; then
            echo "‚úÖ Running snake created!"
            echo "Preview of snake pattern:"
            grep -o "d=\"[^\"]*\"" snake.svg | head -3
          else
            echo "‚ö†Ô∏è Trying alternative method..."
            # –°–ø–æ—Å–æ–± 2: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å
            curl -s "https://raw.githubusercontent.com/Platane/snk/output/github-contribution-grid-snake.svg?user=djedra" > snake.svg
          fi
          
          # –°–æ–∑–¥–∞–µ–º —Ç–µ–º–Ω—É—é –≤–µ—Ä—Å–∏—é
          curl -s "https://github-contributions-snake.vercel.app/github-snake.svg?user=djedra&theme=dark&snake=true" > snake-dark.svg
      
      # 2. –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
      - name: Generate local snake (fallback)
        if: failure()
        uses: Platane/snk@master
        with:
          github_user_name: djedra
          svg_out_path: snake.svg
      
      # 3. –ö–æ–º–º–∏—Ç–∏–º
      - name: Commit snake
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: "Update running snake animation"
          file_pattern: "snake*.svg"
